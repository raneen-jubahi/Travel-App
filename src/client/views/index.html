<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./dist/style.d14b813fe973e3eddfda.css" /> <!-- تأكد من تحديث هذا -->
    <title>Global Travel Planner</title>
</head>
<body>
    <!-- خلفية الفيديو العالمية -->
    <div class="video-background">
        <video autoplay muted loop>
            <source src="istockphoto-1764432866-640_adpp_is.mp4" type="video/mp4">
        </video>
    </div>

    <div class="container text-center py-5">
        <header class="header mb-5">
            <h1 class="display-2 fw-bold text-white">Where do you want to go?</h1>
            <p class="lead fs-4 text-white">Plan your perfect trip with us and explore the world in style!</p>
        </header>
        
        <form id="tripForm" class="mb-4">
            <div class="row justify-content-center">
                <div class="col-md-6">
                    <div class="input-group mb-3">
                        <input type="text" id="city" class="form-control form-control-lg" placeholder="Enter your Destination" required />
                        <button class="btn btn-primary btn-lg" type="submit">
                            <i class="fas fa-paper-plane"></i> Submit
                        </button>
                    </div>
                    <input type="date" id="flightDate" class="form-control form-control-lg mb-3" required />
                    <div id="city_error" class="alert alert-danger d-none"></div>
                </div>
            </div>
        </form>

        <div id="tripDetails" class="trip-details p-5 mb-3 shadow-lg rounded bg-white"></div>
        <button id="printTrip" class="btn btn-secondary btn-lg mt-3 d-none">
            Print Trip <i class="fas fa-print"></i>
        </button>
    </div>

    <script>
        document.getElementById('tripForm').addEventListener('submit', async function(event) {
            event.preventDefault();
            const city = document.getElementById('city').value;
            const date = document.getElementById('flightDate').value;

            const weatherData = await getWeatherData(city);
            if (weatherData) {
                displayTripDetails(city, date, weatherData);
            }
        });

        async function getWeatherData(city) {
            try {
                const response = await fetch(`https://api.weatherapi.com/v1/current.json?key=f2f6b3ef801c439a9684e706de682f38&q=${city}`);
                const data = await response.json();

                if (!data.current) {
                    throw new Error("City not found");
                }

                return {
                    temp: data.current.temp_c,
                    maxTemp: data.forecast.forecastday[0].day.maxtemp_c,
                    minTemp: data.forecast.forecastday[0].day.mintemp_c,
                    weatherDescription: data.current.condition.text,
                    cityPic: data.current.condition.icon ? `https:${data.current.condition.icon}` : "https://via.placeholder.com/800x600"
                };
            } catch (error) {
                console.error("Error fetching weather data:", error);
                document.getElementById('city_error').textContent = "Error fetching data. Please try again.";
                document.getElementById('city_error').classList.remove('d-none');
                return null;
            }
        }

        function displayTripDetails(city, date, weatherData) {
            document.getElementById('tripDetails').innerHTML = `
                <h3 class="display-5">Your Trip Summary</h3>
                <p><strong>Destination:</strong> ${city}</p>
                <p><strong>Date:</strong> ${date}</p>
                <p><strong>Temperature:</strong> ${weatherData.temp} °C</p>
                <p><strong>Weather:</strong> ${weatherData.weatherDescription}</p>
                <img src="${weatherData.cityPic}" alt="City Image" class="img-fluid rounded shadow" />
            `;
            document.getElementById('tripDetails').style.display = 'block'; // إظهار التفاصيل
            document.getElementById('printTrip').classList.remove('d-none'); // إظهار زر الطباعة
        }

        document.getElementById('printTrip').addEventListener('click', printTripDetails);

        function printTripDetails() {
            const tripSummary = document.getElementById('tripDetails').innerHTML;
            const printWindow = window.open('', '', 'height=400,width=600');
            printWindow.document.write('<html><head><title>Print Trip Summary</title></head><body>');
            printWindow.document.write(tripSummary);
            printWindow.document.write('</body></html>');
            printWindow.document.close();
            printWindow.print();
        }
    </script>
</body>
</html>
